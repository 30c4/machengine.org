<!doctype html><html><head><link rel=stylesheet href=https://machengine.org/next/layouts/default.a0ed90a5d8e726209869a7145c94e535bb0e6b23be91f635a17446917478cfa3.css><link rel=stylesheet href=https://machengine.org/next/assets/font/stylesheet.css><script async defer data-domain=hexops.com src=https://machengine.org/opendata.js></script><meta charset=utf-8><title>mach/glfw: perfected GLFW bindings for Zig | Mach engine - game engine & graphics toolkit for the future</title><link rel=canonical href=https://machengine.org/next/docs/libs/glfw/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="mach/glfw: perfected GLFW bindings for Zig"><meta property="og:description" content="mach/glfw provides GLFW bindings for Zig with 100% API coverage, zero-fuss installation, cross-compilation, and more."><meta property="og:type" content="article"><meta property="og:url" content="https://machengine.org/next/docs/libs/glfw/"><meta property="article:section" content="docs"><meta name=twitter:card content="summary"><meta name=twitter:title content="mach/glfw: perfected GLFW bindings for Zig"><meta name=twitter:description content="mach/glfw provides GLFW bindings for Zig with 100% API coverage, zero-fuss installation, cross-compilation, and more."></head><body><div class=navbar><div class=content><a href=https://machengine.org/next/ class=logo><div class=img></div></a><div><a href=https://machengine.org/next/docs class="item glass-link">docs</a>
<a href=https://github.com/sponsors/slimsag class="item glass-link">donate</a>
<a href=https://devlog.hexops.com/categories/mach/ class="item glass-link">devlog</a>
<a href=https://github.com/hexops/mach class="svg-item glass-link"><img alt=GitHub class=svg-icon src=https://machengine.org/next/img/github.svg></a>
<a href=https://discord.gg/XNG3NZgCqp class="svg-item glass-link"><img alt=Discord class=svg-icon src=https://machengine.org/next/img/discord.svg></a></div></div></div><div class="alert next"><span><strong>HEY YOU!</strong> We're still working on this site, please don't share it in very public places :)</span></div><div class="alert not-next"><span><strong>Mach v0.2 has been released!</strong> For all the details check out <a href=https://devlog.hexops.com/2022/perfecting-webgpu-native/>the announcement</a></span></div><div id=content><link rel=stylesheet href=https://machengine.org/next/layouts/docs.72bffc77280cdb03f69f8e25929ff163b21f8a6648f1ace5dffa13cdd76ef5dd.css><main aria-role=main class=main-docs><aside><ul><li><a href=https://machengine.org/next/docs><span>Choose your journey</span></a></li><li><h3><span>Engine</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/docs/engine>Overview</a></li></ul><li><h3><span>Core</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/docs/core>Overview</a></li><li><a href=https://machengine.org/next/docs/core/examples>Examples</a></li><li><a href=https://machengine.org/next/docs/core/getting-started>Getting started</a></li><li><a href=https://machengine.org/next/docs/core/known-issues>Known issues</a></li><li><a href=https://machengine.org/next/docs/core/migrations>Migrations</a></li></ul><li><h3><span>Libraries</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/docs/libs>Overview</a></li><li><a href=https://machengine.org/next/docs/libs/glfw>mach/glfw</a></li><li><a href=https://machengine.org/next/docs/libs/gpu>mach/gpu</a></li><li><a href=https://machengine.org/next/docs/libs/freetype>mach/freetype</a></li><li><a href=https://machengine.org/next/docs/libs/experimental>Experimental</a></li></ul><li><h3><span>About</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/docs/about/goals>Project goals</a></li></ul></ul></aside><div class=docs><h1 id=perfected-glfw-bindings-for-zig>Perfected GLFW bindings for Zig</h1><div style=margin-top:2rem><a href=https://github.com/hexops/mach-glfw class=img-link style=float:right;padding-left:1rem><picture><source media="(prefers-color-scheme: dark)" srcset=https://machengine.org/next/assets/mach/glfw-dark.svg><img alt=mach/glfw src=https://machengine.org/next/assets/mach/glfw-light.svg style=width:20rem;margin-right:1rem;margin-top:.5rem></picture></a>
As with all Mach libraries, <a href=../../about/goals#zero-fuss-installation>zero-fuss installation</a>, <a href=../../about/goals#seamless-cross-compilation>cross-compilation</a> at the flip of a switch, and <a href=../../about/goals#platform-support>broad platform support</a> is guaranteed.<br><br><span style=font-family:Orbitron><em>Quick links:</em></span><br><ul style=display:inline-block><li><a href=https://github.com/hexops/mach-glfw>mach/glfw on GitHub</a></li><li><a href=https://devlog.hexops.com/2021/perfecting-glfw-for-zig-and-finding-undefined-behavior/>Perfecting GLFW for Zig</a> (article)</li></ul></div><h2 id=features>Features</h2><h3 style=margin-top:1rem>100% API coverage, 130+ tests, etc.</h3><p><code>mach/glfw</code> bindings have 100% API coverage of GLFW v3.3.4. Every function, type, constant, etc. has been wrapped in a ziggified API.</p><p>There are 130+ tests, and CI tests on all major platforms as well as cross-compilation between platforms:</p><h3 style=margin-top:2rem>Ziggified GLFW API</h3><p>Why create a ziggified GLFW wrapper, instead of just using <code>@cImport</code> and interfacing with GLFW directly? You get:</p><ul><li>Comptime guarantees like ensuring you called <code>glfw.Init()</code> before any other method which requires init first.</li><li><code>true</code> and <code>false</code> instead of <code>c.GLFW_TRUE</code> and <code>c.GLFW_FALSE</code> constants.</li><li>Generics, so you can just use <code>window.hint</code> instead of <code>glfwWindowHint</code>, <code>glfwWindowHintString</code>, etc.</li><li><strong>Enums</strong>, always know what value a GLFW function can accept as everything is strictly typed. And use the nice Zig syntax to access enums, like <code>window.getKey(.escape)</code> instead of <code>c.glfwGetKey(window, c.GLFW_KEY_ESCAPE)</code></li><li>Slices instead of C pointers and lengths.</li><li><a href=https://ziglang.org/documentation/master/#packed-struct>packed structs</a> represent bit masks, so you can use <code>if (joystick.down and joystick.right)</code> instead of <code>if (joystick & c.GLFW_HAT_DOWN and joystick & c.GLFW_HAT_RIGHT)</code>, etc.</li><li>Methods, e.g. <code>my_window.hint(...)</code> instead of <code>glfwWindowHint(my_window, ...)</code></li></ul><h2 id=examples>Examples</h2><h3 style=margin-top:1rem>Vulkan</h3><p><img src=https://user-images.githubusercontent.com/3173176/139573985-d862f35a-e78e-40c2-bc0c-9c4fb68d6ecd.png style=width:20rem;float:left>
Since mach/glfw is only bindings to GLFW, you'll need to bring-your-own Vulkan library if that is how you intend to use it.<br><br>For a Vulkan usage example, see <a href=https://github.com/hexops/mach-glfw-vulkan-example>mach-glfw-vulkan-example</a> - but note that it may not have the same broad platform support / cross-compilation guarantees due to using external libraries.</p><h3 style=margin-top:2rem>OpenGL</h3><p><img src=https://user-images.githubusercontent.com/3173176/203870354-0a5d9349-02db-49d0-9666-483d15a41cbb.png style=width:20rem;float:right>
Since mach/glfw is only bindings to GLFW, you'll need to bring-your-own OpenGL library if that is how you intend to use it.<br><br>For a OpenGL usage example, see <a href=https://github.com/hexops/mach-glfw-opengl-example>mach-glfw-opengl-example</a> - but note that it may not have the same broad platform support / cross-compilation guarantees due to using external libraries.</p><h3 style=margin-top:2rem>WebGPU</h3><p>WebGPU requires a bit of setup code, and a WebGPU implementation is required. If you like, you can use our standalone mach/gpu bindings with the mach/gpu-dawn implementation of WebGPU and bind it to a GLFW window following <a href=https://github.com/hexops/mach-gpu/tree/main/examples>this example</a>.<br><br>If you are considering this option, we suggest <a href=../core>Mach core</a> as it would provide you with the same functionality (Window+Input+WebGPU) with much broader platform support (e.g. you get mobile/web support in the future for free.)</p><h2 id=getting-started>Getting started</h2><h3 id=adding-dependency>Adding dependency</h3><p>In a <code>libs</code> subdirectory of the root of your project:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>git clone https://github.com/hexops/mach-glfw
</code></pre></div><p>Then in your <code>build.zig</code> add:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig>...
<span style=color:#66d9ef>const</span> glfw <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;libs/mach-glfw/build.zig&#34;</span>);

<span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> build(b<span style=color:#f92672>:</span> <span style=color:#f92672>*</span>Builder) <span style=color:#f92672>!</span><span style=color:#66d9ef>void</span> {
    ...
    exe.addPackage(glfw.pkg(b));
    <span style=color:#66d9ef>try</span> glfw.link(b, exe, .{});
}
</code></pre></div><h3 id=usage>Usage</h3><p>Now in your code you may import and use GLFW:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig><span style=color:#66d9ef>const</span> glfw <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;glfw&#34;</span>);

<span style=color:#75715e>/// Default GLFW error handling callback
</span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> errorCallback(error_code<span style=color:#f92672>:</span> glfw.ErrorCode, description<span style=color:#f92672>:</span> [<span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>]<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>u8</span>) <span style=color:#66d9ef>void</span> {
    std.log.err(<span style=color:#e6db74>&#34;glfw: {}: {s}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, .{ error_code, description });
}

<span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> main() <span style=color:#f92672>!</span><span style=color:#66d9ef>void</span> {
    glfw.setErrorCallback(errorCallback);
    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>glfw.init(.{})) {
        std.log.err(<span style=color:#e6db74>&#34;failed to initialize GLFW: {?s}&#34;</span>, .{glfw.getErrorString()});
        std.process.exit(<span style=color:#ae81ff>1</span>);
    }
    <span style=color:#66d9ef>defer</span> glfw.terminate();

    <span style=color:#75715e>// Create our window
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> window <span style=color:#f92672>=</span> glfw.Window.create(<span style=color:#ae81ff>640</span>, <span style=color:#ae81ff>480</span>, <span style=color:#e6db74>&#34;Hello, mach-glfw!&#34;</span>, <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>null</span>, .{}) <span style=color:#66d9ef>orelse</span> {
        std.log.err(<span style=color:#e6db74>&#34;failed to create GLFW window: {?s}&#34;</span>, .{glfw.getErrorString()});
        std.process.exit(<span style=color:#ae81ff>1</span>);
    };
    <span style=color:#66d9ef>defer</span> window.destroy();

    <span style=color:#75715e>// Wait for the user to close the window.
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span>window.shouldClose()) {
        glfw.pollEvents();
    }
}
</code></pre></div><h2 id=error-handling>Error handling</h2><p>For details on why our GLFW bindings don&rsquo;t return Zig errors, see <a href=https://github.com/hexops/mach/pull/662>this PR</a> - the TL;DR is that GLFW errors rarely signal a problem where your application should <em>exit</em>.</p><p>You should be very mindful about what you do when you encoounter a GLFW error. If it&rsquo;s not truly critical to the execution of your application, you should almost always just print the error and continue trying to run. This will ensure the greatest platform support across e.g. more obscure X11 compositors and Wayland. Write your code to be resilient to GLFW errors and continue running best-effort where possible.</p><h3 id=overview>Overview</h3><p>After making a GLFW function call, you should check errors explicitly. Here are some specific examples:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig><span style=color:#66d9ef>const</span> pos <span style=color:#f92672>=</span> window.getPos();

<span style=color:#75715e>// Option 1: convert a GLFW error into a Zig error.
</span><span style=color:#75715e></span>glfw.getErrorCode() <span style=color:#66d9ef>catch</span> <span style=color:#f92672>|</span>err<span style=color:#f92672>|</span> {
    std.log.err(<span style=color:#e6db74>&#34;failed to get window position: error={}&#34;</span>, .{err});
    <span style=color:#66d9ef>return</span> err; <span style=color:#75715e>// Or fall back to an alternative implementation.
</span><span style=color:#75715e></span>};

<span style=color:#75715e>// Option 2: log a human-readable description of the error.
</span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (glfw.getErrorString()) <span style=color:#f92672>|</span>description<span style=color:#f92672>|</span> {
    std.log.err(<span style=color:#e6db74>&#34;failed to get window position: {s}&#34;</span>, .{description});
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}

<span style=color:#75715e>// Option 3: use a combination of the above approaches.
</span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (glfw.getError()) <span style=color:#f92672>|</span>err<span style=color:#f92672>|</span> {
    <span style=color:#66d9ef>const</span> error_code <span style=color:#f92672>=</span> err.error_code; <span style=color:#75715e>// Zig error
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> description <span style=color:#f92672>=</span> err.description; <span style=color:#75715e>// Human-readable description
</span><span style=color:#75715e></span>    std.log.err(<span style=color:#e6db74>&#34;failed to get window position: error={}: {s}&#34;</span>, .{error_code, description});
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}
</code></pre></div><p>Note that the above example relies on GLFW&rsquo;s saved error being empty; otherwise, previously emitted errors may be mistaken for an error caused by <code>window.getPos()</code>.</p><p>If your application frequently ignores errors, it may be necessary to call <code>glfw.clearError()</code> or <code>defer glfw.clearError()</code> to ensure a clean slate for future error handling.</p><h3 id=creating-a-window>Creating a window</h3><p>Some functions like <code>glfw.Window.create</code> return <code>null</code> in the event of an error, you can handle this by presenting the <code>glfw.getErrorString()</code> value to the user and exiting if appropriate.</p><h3 id=other-glfw-api-calls>Other GLFW API calls</h3><p>In general, you should be explicit about handling errors. Ask yourself: if this code fails, does my application <em>need</em> to exit, or can I continue best-effort? If your application needs to exit because the API call was critical, then add an error check to present the problem:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig>glfw.foobar();
<span style=color:#66d9ef>if</span> (glfw.getErrorString()) <span style=color:#f92672>|</span>msg<span style=color:#f92672>|</span> {
    std.log.err(<span style=color:#e6db74>&#34;glfw.foobar: {s}&#34;</span>, .{msg});
    std.process.exit(<span style=color:#ae81ff>1</span>);
}
</code></pre></div><p>Keep in mind that GLFW errors are stored per-thread. If you call a function and it produces an error and you do not retrieve it, then the next person who checks for an error will find it. This means that you may find it useful to be a good citizen by &ldquo;clearing&rdquo; any stored errors that you do not care about when finished calling GLFW functions, e.g. using defer:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig><span style=color:#66d9ef>defer</span> getError() <span style=color:#66d9ef>catch</span> {}; <span style=color:#75715e>// clear any errors we generated
</span></code></pre></div></div><div class=toc><h3>Table of contents</h3><nav id=TableOfContents><ul><li><a href=#features>Features</a></li><li><a href=#examples>Examples</a></li><li><a href=#getting-started>Getting started</a><ul><li><a href=#adding-dependency>Adding dependency</a></li><li><a href=#usage>Usage</a></li></ul></li><li><a href=#error-handling>Error handling</a><ul><li><a href=#overview>Overview</a></li><li><a href=#creating-a-window>Creating a window</a></li><li><a href=#other-glfw-api-calls>Other GLFW API calls</a></li></ul></li></ul></nav></div></main><div class=footer><a href=https://hexops.com/privacy>Privacy matters</a><p><a href=https://machengine.org/next/docs#improve-this-site>Improve this site</a> | <a href=https://github.com/sponsors/slimsag>Sponsor on GitHub</a> | <a href=https://devlog.hexops.com/>Hexops' devlog</a></p></div></div></body></html>