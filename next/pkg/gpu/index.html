<!doctype html><html><head><link rel=stylesheet href=https://machengine.org/next/layouts/default.9af34c83dd334eeaf345e328c050f5d9a522354e2a594ab12f46bd2032529363.css><link rel=apple-touch-icon sizes=180x180 href=https://machengine.org/next/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://machengine.org/next/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://machengine.org/next/favicon-16x16.png><link rel=manifest href=https://machengine.org/next/site.webmanifest><link rel=mask-icon href=https://machengine.org/next/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://machengine.org/next/assets/font/stylesheet.css><link rel=stylesheet href=https://machengine.org/next/assets/font/inter/inter.css><script async defer data-domain=hexops.com src=https://machengine.org/next/opendata.js></script><meta charset=utf-8><title>mach-gpu: the WebGPU interface for Zig | Mach: zig game engine & graphics toolkit</title><link rel=canonical href=https://machengine.org/next/pkg/gpu/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noindex"><meta property="og:title" content="mach-gpu: the WebGPU interface for Zig"><meta property="og:description" content="mach-gpu provides a truly cross-platform graphics API for Zig (desktop, mobile, and web) with unified low-level graphics & compute backed by Vulkan, Metal, D3D12, and OpenGL (as a best-effort fallback.)"><meta property="og:type" content="article"><meta property="og:url" content="https://machengine.org/next/pkg/gpu/"><meta property="og:image" content="https://machengine.org/next/opengraph/template_hu102e162f47cb7d8ae9eb284939698b9d_62022_564fce443f34f261cd20eeaaa0eba0c3.png"><meta property="article:section" content="pkg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://machengine.org/next/opengraph/template_hu102e162f47cb7d8ae9eb284939698b9d_62022_564fce443f34f261cd20eeaaa0eba0c3.png"><meta name=twitter:title content="mach-gpu: the WebGPU interface for Zig"><meta name=twitter:description content="mach-gpu provides a truly cross-platform graphics API for Zig (desktop, mobile, and web) with unified low-level graphics & compute backed by Vulkan, Metal, D3D12, and OpenGL (as a best-effort fallback.)"></head><body><div class=navbar><div class=content><a href=https://machengine.org/next/ class=logo><div class=img></div></a><div><a href=https://machengine.org/next/engine class=item>Engine</a>
<a href=https://machengine.org/next/core class=item>Core</a>
<a href=https://machengine.org/next/pkg class=item>Packages</a>
<a href=https://machengine.org/next/about class=item>Project</a><div style="width:0;height:100%;border-left:1px solid" class=color-border>&nbsp;</div><a href=https://devlog.hexops.com/categories/mach/ class=item>Devlog</a>
<a href=https://github.com/hexops/mach class=svg-item><img alt=GitHub class=svg-icon src=https://machengine.org/next/img/github.svg></a>
<a href=https://discord.gg/XNG3NZgCqp class=svg-item><img alt=Discord class=svg-icon src=https://machengine.org/next/img/discord.svg></a>
<a href=https://github.com/sponsors/slimsag class=donate-button><img alt=Heart class=svg-icon src=https://machengine.org/next/img/heart.svg>
&nbsp;Donate</a></div></div></div><div class="alert warning"><span><strong>HEY YOU!</strong> We're still working on this site, please don't share it in very public places :)</span></div><div id=content><link rel=stylesheet href=https://machengine.org/next/layouts/docs.a2978d86fe897d36c7156a89344e1c3c64909c3c94fc570946c0ca9508158892.css><main aria-role=main class=main-docs><aside><ul><li><a href=https://machengine.org/next/pkg><span>Packages overview</span></a></li><li><a href=https://machengine.org/next/pkg/c><span>C libraries / headers</span></a></li><li><h3><span>Pure Zig</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/pkg/mach-ecs>ecs</a></li><li><a href=https://machengine.org/next/pkg/mach-sysaudio>sysaudio</a></li><li><a href=https://machengine.org/next/pkg/mach-pure-sysjs>sysjs</a></li><li><a href=https://machengine.org/next/pkg/mach-dusk>dusk</a></li><li><a href=https://machengine.org/next/pkg/mach-gamemode>gamemode</a></li><li><a href=https://machengine.org/next/pkg/mach-earcut>earcut</a></li><li><a href=https://machengine.org/next/pkg/mach-fastfilter>fastfilter</a></li></ul><li><h3><span>Bindings</span></h3></li><ul class=sub-menu><li><a href=https://machengine.org/next/pkg/mach-gpu>gpu</a></li><li><a href=https://machengine.org/next/pkg/mach-gpu-dawn>gpu-dawn</a></li><li><a href=https://machengine.org/next/pkg/mach-basisu>basisu</a></li><li><a href=https://machengine.org/next/pkg/mach-freetype>freetype</a></li><li><a href=https://machengine.org/next/pkg/mach-glfw>glfw</a></li><li><a href=https://machengine.org/next/pkg/mach-model3d>model3d</a></li><li><a href=https://machengine.org/next/pkg/mach-opus>opus</a></li><li><a href=https://machengine.org/next/pkg/mach-flac>flac</a></li></ul></ul></aside><div class=docs><h1 id=the-webgpu-interface-for-zig>The WebGPU interface for Zig</h1><div style=margin-top:2rem><a href=https://github.com/hexops/mach-gpu class=img-link style=float:right;padding-left:1rem><picture><source media="(prefers-color-scheme: dark)" srcset=https://machengine.org/next/assets/mach/gpu-dark.svg><img alt=mach-gpu src=https://machengine.org/next/assets/mach/gpu-light.svg style=width:20rem;margin-right:1rem;margin-top:.5rem></picture></a>
As with all Mach libraries, <a href=../../about/goals#zero-fuss-installation>zero-fuss installation</a>, <a href=../../about/goals#seamless-cross-compilation>cross-compilation</a> at the flip of a switch, and <a href=../../about/goals#platform-support>broad platform support</a> is guaranteed.<br><br><span style=font-family:Orbitron><em>Quick links:</em></span><br><ul style=display:inline-block;width:25rem><li><a href=https://github.com/hexops/mach-gpu>mach-gpu on GitHub</a></li><li><a href=https://devlog.hexops.com/2022/perfecting-webgpu-native/>Perfecting WebGPU/Dawn native graphics for Zig</a> (article)</li><li><a href=https://devlog.hexops.com/2021/mach-engine-the-future-of-graphics-with-zig/>Perfecting The future of graphics with Zig</a> (article)</li></ul></div><h2 id=goals>Goals</h2><ul><li>Allow comptime-defined interception of WebGPU API requests (comptime interfaces.)</li><li>Expose a standard Dawn <code>webgpu.h</code>-compliant C ABI, which routes through Zig comptime interfaces.</li><li>Support Dawn (native) and Browser (via WASM/JS) implementations of WebGPU.</li><li>Broad platform support: desktop, mobile, web, consoles in the future.</li><li>First-class Linux support (support Wayland, OpenGL and OpenGL ES fallbacks, etc.)</li></ul><h2 id=non-goals>Non-goals</h2><ul><li>We will not support non-Dawn (e.g. Rust wgpu) implementations if they don&rsquo;t match the same <code>webgpu.h</code> interface as Dawn. In general they often match, but not always.</li><li>We will not maintain backwards compatibility with deprecated <code>webgpu.h</code> methods for now.</li></ul><h2 id=features>Features</h2><h3 id=compile-time-interface>Compile-time interface</h3><p><strong>mach-gpu</strong> is a low level library providing <a href=https://devlog.hexops.com/2022/perfecting-webgpu-native/#comptime-interfaces>a compile-time interface</a> to the WebGPU API. Because it is a compile-time interface, it has zero-overhead compared to calling the WebGPU C API directly.</p><p>There are multiple <em>implementations</em> of the interface, including:</p><ul><li><a href=mach-gpu-dawn>mach-gpu-dawn</a> - backed by Dawn, the native WebGPU implementation used in Google Chrome.</li><li><a href=mach-gpu-dusk>mach-gpu-dusk</a> - a highly experimental pure Zig WebGPU implementation</li><li>(future) A WebAssembly implementation, using the browser&rsquo;s builtin implementation.</li></ul><h3 id=gpuexport>gpu.Export</h3><p><code>mach-gpu</code> provides a <code>gpu.Export</code> function which takes a Zig implementation of the WebGPU interface and exposes all of the neccessary functions for a <code>webgpu.h</code> compatible C ABI.</p><p>This does two things:</p><ol><li>Makes it possible to expose a Zig WebGPU implementation as a standard C API easily, with type-checking, etc.</li><li>Allows <em>intercepting</em> WebGPU API calls (even those issued from C libraries) in Zig code. For example, one can intercept all Dawn API calls that Dear Imgui&rsquo;s WebGPU backend issues as a result. This opens the door to exploring some interesting debugging facitilies for WebGPU in the future.</li></ol><h3 id=quality-of-life-improvements>Quality of life improvements</h3><p>The library provides a number of quality of life improvements which you can <a href=https://github.com/hexops/mach-gpu/blob/main/README.md#quality-of-life-improvements>read about in detail here</a>, including:</p><ul><li>Zig flag sets</li><li>Default values everywhere to reduce verbosity of descriptor usage.</li><li>Slice helpers instead of raw pointers+lengths.</li><li>Typed callback <code>userdata</code> pointers.</li><li>Type-safety for <code>next_in_chain</code> extensions</li><li>Helper methods</li></ul><p>Despite these, you can <em>always</em> access the raw <code>webgpu.h</code> API with none of our helpers on top using <code>gpu.Impl.foobar()</code> methods.</p><h2 id=examples>Examples</h2><h3 id=webgpu--glfw-example>WebGPU + GLFW example</h3><p>Since mach-gpu is just a comptime interface, you must provide an implementation. That implementation must also be bound to e.g. a DirectX/Vulkan/Metal window provided by e.g. GLFW.</p><p>We provide <a href=https://github.com/hexops/mach-gpu/tree/main/examples>a standalone example</a> which demonstrates using <code>mach-gpu</code>, the <code>mach-gpu-dawn</code> implementation, and <code>mach-glfw</code> to create the window.</p><h3 id=consider-mach-core>Consider Mach core</h3><p>WebGPU requires a bit of setup code, if you are considering using WebGPU + GLFW we encourage considering <a href=../core>Mach core</a> as it would provide you with the same functionality (Window+Input+WebGPU, nothing else) with much broader platform support (e.g. you get mobile/web support in the future for free.)</p><p>Even if you decide to just use mach-gpu, you may find the <a href=../core/examples>Mach core examples</a> to be a helpful resource for learning how to use WebGPU.</p><h2 id=getting-started>Getting started</h2><h3 id=adding-dependency>Adding dependency</h3><p>In a <code>libs</code> subdirectory of the root of your project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git clone https://github.com/hexops/mach-gpu
</span></span></code></pre></div><p>Then in your <code>build.zig</code> add:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zig data-lang=zig><span style=display:flex><span><span style=color:#75715e>// Import dependencies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> system_sdk <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;libs/mach-glfw/system_sdk.zig&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> glfw <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;libs/mach-glfw/build.zig&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> gpu_dawn <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;libs/mach-gpu-dawn/sdk.zig&#34;</span>).Sdk(.{
</span></span><span style=display:flex><span>    .glfw <span style=color:#f92672>=</span> glfw,
</span></span><span style=display:flex><span>    .glfw_include_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;glfw/upstream/glfw/include&#34;</span>,
</span></span><span style=display:flex><span>    .system_sdk <span style=color:#f92672>=</span> system_sdk,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> gpu <span style=color:#f92672>=</span> @import(<span style=color:#e6db74>&#34;libs/mach-gpu/sdk.zig&#34;</span>).Sdk(.{
</span></span><span style=display:flex><span>    .glfw <span style=color:#f92672>=</span> glfw,
</span></span><span style=display:flex><span>    .gpu_dawn <span style=color:#f92672>=</span> gpu_dawn,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> build(b<span style=color:#f92672>:</span> <span style=color:#f92672>*</span>Builder) <span style=color:#f92672>!</span><span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Link to mach-gpu
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    exe.addModule(<span style=color:#e6db74>&#34;gpu&#34;</span>, gpu.module(b));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> gpu.link(b, exe, .{});
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=toc><h3>Table of contents</h3><nav id=TableOfContents><ul><li><a href=#goals>Goals</a></li><li><a href=#non-goals>Non-goals</a></li><li><a href=#features>Features</a><ul><li><a href=#compile-time-interface>Compile-time interface</a></li><li><a href=#gpuexport>gpu.Export</a></li><li><a href=#quality-of-life-improvements>Quality of life improvements</a></li></ul></li><li><a href=#examples>Examples</a><ul><li><a href=#webgpu--glfw-example>WebGPU + GLFW example</a></li><li><a href=#consider-mach-core>Consider Mach core</a></li></ul></li><li><a href=#getting-started>Getting started</a><ul><li><a href=#adding-dependency>Adding dependency</a></li></ul></li></ul></nav></div></main><div class=footer><a href=https://hexops.com/privacy>Privacy matters</a><p><a href=https://machengine.org/next/about#improve-this-site>Improve this site</a> | <a href=https://github.com/sponsors/slimsag>Sponsor on GitHub</a> | <a href=https://devlog.hexops.com/>Hexops' devlog</a></p></div></div></body></html>